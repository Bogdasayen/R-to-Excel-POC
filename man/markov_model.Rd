% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/markov_model.R
\name{markov_model}
\alias{markov_model}
\title{The Markov model class}
\description{
Markov model class
}
\examples{
markov_smoking <- markov_model$new(n_states = 2, n_cycles = 10, n_samples = 1000, n_treatments = 2, v_state_names = c("Smoking", "Not smoking"), v_treatment_names = c("SoC", "SoC with website"), lambda = 20000, costs_dr = 0.035, qalys_dr = 0.035)


## ------------------------------------------------
## Method `markov_model$new`
## ------------------------------------------------

markov_smoking <- markov_model$new(n_states = 2, n_cycles = 10, n_samples = 1000, n_treatments = 2, v_state_names = c("Smoking", "Not smoking"), v_treatment_names = c("SoC", "SoC with website"), lambda = 20000, costs_dr = 0.035, qalys_dr = 0.035, markov_inputs = smoking_inputs, v_init_cohort = c(1, 0))

## ------------------------------------------------
## Method `markov_model$generate_input_parameters`
## ------------------------------------------------

smoking_markov_model$generate_input_parameters(n_samples = 10000)

## ------------------------------------------------
## Method `markov_model$generate_transition_matrices`
## ------------------------------------------------

smoking_markov_model$generate_transition_matrices()

## ------------------------------------------------
## Method `markov_model$generate_markov_trace`
## ------------------------------------------------

smoking_markov_model$generate_markov_trace()

## ------------------------------------------------
## Method `markov_model$export_to_excel`
## ------------------------------------------------

smoking_markov_model$export_to_excel("output/test_workbook.xlsx", startCol = 5, startRow = 8)
smoking_markov_model$export_to_excel("output/test_workbook.xlsm", startCol = 5, startRow = 8, psa_startCol = 5, psa_startRow = 1)
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{n_states}}{Number of states for the Markov model}

\item{\code{n_cycles}}{Number of cycles for the cohort simulation}

\item{\code{n_parameters}}{Number of parameters in the model}

\item{\code{n_samples}}{Number of probabilistic samples}

\item{\code{n_treatments}}{Number of treatments, including the reference}

\item{\code{v_state_names}}{Vector of length n_states}

\item{\code{v_treatment_names}}{Vector of length n_treatments}

\item{\code{lambda}}{Willingness-to-pay threshold for net monetary benefit}

\item{\code{costs_dr}}{Discount rate for costs per cycle for cohort simulation (e.g., 5\% is costs_dr = 0.05)}

\item{\code{qalys_dr}}{Discount rate for QALYs or other effects per cycle for cohort simulation (e.g., 5\% is qalys_dr = 0.05)}

\item{\code{markov_inputs}}{An object of R6 class input_parameters with description and (optional) sampled values}

\item{\code{a_transition_matrices}}{Array of (time-homogeneous) random transition matrices with dimensions n_samples by n_states by n_states}

\item{\code{a_cohort_array}}{Array of cohort vectors with dimensions n_treatments x n_samples x n_cycles x n_states}

\item{\code{v_init_cohort}}{Initial cohort vector shared across treatments and samples}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-markov_model-new}{\code{markov_model$new()}}
\item \href{#method-markov_model-generate_input_parameters}{\code{markov_model$generate_input_parameters()}}
\item \href{#method-markov_model-generate_transition_matrices}{\code{markov_model$generate_transition_matrices()}}
\item \href{#method-markov_model-generate_markov_trace}{\code{markov_model$generate_markov_trace()}}
\item \href{#method-markov_model-export_to_excel}{\code{markov_model$export_to_excel()}}
\item \href{#method-markov_model-clone}{\code{markov_model$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-markov_model-new"></a>}}
\if{latex}{\out{\hypertarget{method-markov_model-new}{}}}
\subsection{Method \code{new()}}{
Initialise the Markov model

Function to use Markov modelling to simulate total costs, QALYs and net benefit
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{markov_model$new(
  n_states,
  n_cycles,
  n_samples,
  n_treatments,
  v_state_names,
  v_treatment_names,
  lambda,
  costs_dr,
  qalys_dr,
  markov_inputs,
  v_init_cohort
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{n_states}}{Number of states for the Markov model}

\item{\code{n_cycles}}{Number of cycles for the cohort simulation}

\item{\code{n_samples}}{Number of probabilistic samples}

\item{\code{n_treatments}}{Number of treatments, including the reference}

\item{\code{v_state_names}}{Vector of length n_states}

\item{\code{v_treatment_names}}{Vector of length n_treatments}

\item{\code{lambda}}{Willingness-to-pay threshold for net monetary benefit}

\item{\code{costs_dr}}{Discount rate for costs per cycle for cohort simulation (e.g., 5\% is costs_dr = 0.05)}

\item{\code{qalys_dr}}{Discount rate for QALYs or other effects per cycle for cohort simulation (e.g., 5\% is qalys_dr = 0.05)}

\item{\code{markov_inputs}}{An object of R6 class input_parameters description}

\item{\code{v_init_cohort}}{Vector representing initial proportion in each cohort}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
An initialised Markov model
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{markov_smoking <- markov_model$new(n_states = 2, n_cycles = 10, n_samples = 1000, n_treatments = 2, v_state_names = c("Smoking", "Not smoking"), v_treatment_names = c("SoC", "SoC with website"), lambda = 20000, costs_dr = 0.035, qalys_dr = 0.035, markov_inputs = smoking_inputs, v_init_cohort = c(1, 0))
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-markov_model-generate_input_parameters"></a>}}
\if{latex}{\out{\hypertarget{method-markov_model-generate_input_parameters}{}}}
\subsection{Method \code{generate_input_parameters()}}{
Function to generate random parameters for the Markov model
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{markov_model$generate_input_parameters(n_samples = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{n_samples}}{Number of parameter samples (default NULL and uses current markov_model number of samples)}
}
\if{html}{\out{</div>}}
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{smoking_markov_model$generate_input_parameters(n_samples = 10000)
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-markov_model-generate_transition_matrices"></a>}}
\if{latex}{\out{\hypertarget{method-markov_model-generate_transition_matrices}{}}}
\subsection{Method \code{generate_transition_matrices()}}{
Function to fill in the transition matrices array
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{markov_model$generate_transition_matrices()}\if{html}{\out{</div>}}
}

\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{smoking_markov_model$generate_transition_matrices()
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-markov_model-generate_markov_trace"></a>}}
\if{latex}{\out{\hypertarget{method-markov_model-generate_markov_trace}{}}}
\subsection{Method \code{generate_markov_trace()}}{
Function to generate the Markov trace (i.e., values for cohort matrix over time)
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{markov_model$generate_markov_trace()}\if{html}{\out{</div>}}
}

\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{smoking_markov_model$generate_markov_trace()
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-markov_model-export_to_excel"></a>}}
\if{latex}{\out{\hypertarget{method-markov_model-export_to_excel}{}}}
\subsection{Method \code{export_to_excel()}}{
Function to add the Markov trace calculation to an Excel workbook
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{markov_model$export_to_excel(
  wb_filename,
  startCol = 5,
  startRow = 8,
  psa_startCol = 6,
  psa_startRow = 1
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{wb_filename}}{Location of the Excel workbook to which sheets will be added}

\item{\code{startCol}}{Starting column number}

\item{\code{startRow}}{Starting row number}

\item{\code{psa_startCol}}{Location of cells to which numbers of states, treatments, and cycles are added}

\item{\code{psa_startRow}}{Location of cells to which numbers of states, treatments, and cycles are added}
}
\if{html}{\out{</div>}}
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{smoking_markov_model$export_to_excel("output/test_workbook.xlsx", startCol = 5, startRow = 8)
smoking_markov_model$export_to_excel("output/test_workbook.xlsm", startCol = 5, startRow = 8, psa_startCol = 5, psa_startRow = 1)
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-markov_model-clone"></a>}}
\if{latex}{\out{\hypertarget{method-markov_model-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{markov_model$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
